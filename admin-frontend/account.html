<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>تعديل البروفايل - لوحة الأدمن</title>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700;800&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.rtl.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --primary-color: #667eea;
            --secondary-color: #764ba2;
            --light-bg: #f5f7fb;
            --card-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            --hover-shadow: 0 8px 20px rgba(0, 0, 0, 0.12);
        }
        
        * {
            box-sizing: border-box;
        }
        
        html, body {
            width: 100%;
            overflow-x: hidden;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Tajawal', sans-serif;
            background-color: var(--light-bg);
            color: #333;
            transition: background-color 0.3s ease;
        }
        
        .navbar {
            background: var(--primary-gradient) !important;
            box-shadow: 0 2px 10px rgba(0,0,0,0.15);
            padding: 0.75rem 0;
        }
        
        .page-header {
            background: white;
            border-bottom: 1px solid rgba(0,0,0,0.05);
            padding: 1.2rem 0;
            margin-bottom: 1.5rem;
        }
        
        .page-title {
            font-weight: 700;
            color: #333;
            margin-bottom: 0.3rem;
            font-size: 1.4rem;
        }
        
        .page-subtitle {
            color: #6c757d;
            font-size: 0.85rem;
        }
        
        .card {
            border: none;
            border-radius: 12px;
            box-shadow: var(--card-shadow);
            transition: all 0.3s ease;
            overflow: hidden;
            margin-bottom: 1.5rem;
        }
        
        .card:hover {
            box-shadow: var(--hover-shadow);
            transform: translateY(-3px);
        }
        
        .card-header {
            background: white;
            border-bottom: 1px solid rgba(0,0,0,0.05);
            padding: 1rem 1.25rem;
            font-weight: 600;
            color: #333;
            font-size: 0.95rem;
        }
        
        .card-body {
            padding: 1.25rem;
        }
        
        .profile-avatar {
            width: 80px;
            height: 80px;
            background: var(--primary-gradient);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            color: white;
            margin: 0 auto 1rem;
            box-shadow: 0 4px 10px rgba(102, 126, 234, 0.3);
        }
        
        .form-label {
            font-weight: 600;
            color: #495057;
            margin-bottom: 0.4rem;
            font-size: 0.9rem;
        }
        
        .form-control {
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 0.6rem 0.8rem;
            transition: all 0.3s ease;
            font-size: 0.9rem;
            width: 100%;
            max-width: 100%;
        }
        
        .form-control:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 0.2rem rgba(102, 126, 234, 0.15);
        }
        
        .btn {
            border-radius: 8px;
            padding: 0.6rem 1.2rem;
            font-weight: 600;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }
        
        .btn-primary {
            background: var(--primary-gradient);
            border: none;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }
        
        .btn-outline-primary {
            color: var(--primary-color);
            border-color: var(--primary-color);
        }
        
        .btn-outline-primary:hover {
            background: var(--primary-color);
            border-color: var(--primary-color);
            transform: translateY(-2px);
        }
        
        .password-input-group {
            position: relative;
        }
        
        .password-toggle {
            position: absolute;
            left: 12px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            color: #6c757d;
            cursor: pointer;
            z-index: 5;
            font-size: 0.9rem;
        }
        
        .password-field {
            padding-left: 40px !important;
        }
        
        .account-info {
            display: flex;
            align-items: center;
            margin-bottom: 1.5rem;
            padding: 0.8rem;
            background: #f8f9fa;
            border-radius: 10px;
        }
        
        .account-icon {
            width: 50px;
            height: 50px;
            background: var(--primary-gradient);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            margin-left: 1rem;
            flex-shrink: 0;
        }
        
        .account-details {
            flex-grow: 1;
        }
        
        .account-name {
            font-weight: 600;
            margin-bottom: 0.2rem;
            font-size: 1rem;
        }
        
        .account-role {
            color: #6c757d;
            font-size: 0.85rem;
        }
        
        .form-control-color {
            width: 60px;
            height: 60px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            padding: 0;
        }
        
        .form-control-color::-webkit-color-swatch {
            border: none;
            border-radius: 6px;
        }
        
        .form-control-color::-webkit-color-swatch-wrapper {
            padding: 0;
        }
        
        .logo-upload-section {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
        }
        
        .save-button {
            background: var(--primary-gradient);
            border: none;
            color: white;
            padding: 0.75rem 2rem;
            border-radius: 8px;
            font-weight: 600;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            margin: 2rem auto 0;
            font-size: 1.1rem;
            min-width: 200px;
        }
        
        .save-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
 .logo-preview {
    width: 366px;
    height: 215px;
    display: flex;
    align-items: center;       /* لمحاذاة عمودياً في الوسط */
    justify-content: center;   /* لمحاذاة أفقياً في الوسط */
    background-color: #f8f9fa;
    overflow: hidden;
    position: relative;
    border-radius: 12px;
    border: 2px dashed #dee2e6;
    flex-wrap: nowrap;
    flex-direction: row;
}


        .logo-img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 10px;
        }
        
        .bg-color-preview {
            width: 100%;
            height: 60px;
            border-radius: 8px;
            border: 2px solid #dee2e6;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 0.5rem;
            background-color: var(--light-bg);
        }
        
        .settings-section {
            margin-bottom: 2rem;
        }
        
        .section-title {
            font-size: 1.1rem;
            font-weight: 700;
            color: #333;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid rgba(0,0,0,0.1);
        }
        
        .logo-actions {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 15px;
        }
        
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            display: none;
        }
        
        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 5px solid #f3f3f3;
            border-top: 5px solid var(--primary-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .validation-error {
            color: #dc3545;
            font-size: 0.8rem;
            margin-top: 5px;
            display: none;
        }
        
        .is-invalid {
            border-color: #dc3545 !important;
        }
        
        .logo-remove-btn {
            position: absolute;
            top: 5px;
            left: 5px;
            background: rgba(220, 53, 69, 0.8);
            color: white;
            border: none;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .logo-preview:hover .logo-remove-btn {
            opacity: 1;
        }

        /* تحسينات التصميم المتكامل */
        .unified-form-section {
            background: white;
            border-radius: 12px;
            box-shadow: var(--card-shadow);
            padding: 0;
            overflow: hidden;
            margin-bottom: 2rem;
        }

        .section-header {
            background: var(--primary-gradient);
            color: white;
            padding: 1.5rem;
            margin-bottom: 0;
        }

        .section-header h3 {
            margin: 0;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .section-content {
            padding: 2rem;
        }

        .form-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            width: 100%;
        }

        .form-column {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
            min-width: 0;
        }

        .settings-group {
            background: #f8f9fa;
            padding: 1.5rem;
            border-radius: 10px;
            border: 1px solid #e9ecef;
            width: 100%;
            max-width: 100%;
        }

        .settings-group h5 {
            color: #495057;
            margin-bottom: 1rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .color-settings {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .color-preview-box {
            width: 80px;
            height: 40px;
            border-radius: 6px;
            border: 2px solid #dee2e6;
            background: var(--light-bg);
        }

        .logo-upload-container {
            text-align: center;
            padding: 1.5rem;
            border: 2px dashed #dee2e6;
            border-radius: 10px;
            background: #f8f9fa;
            transition: all 0.3s ease;
        }

        .logo-upload-container:hover {
            border-color: var(--primary-color);
            background: #e9ecef;
        }

        .action-buttons {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-top: 2rem;
        }

        @media (max-width: 768px) {
            .form-grid {
                grid-template-columns: 1fr;
                gap: 1rem;
            }
            
            .section-content {
                padding: 1rem;
            }
            
            .settings-group {
                padding: 1rem;
            }
            
            body {
                overflow-x: hidden;
            }
            
            .container-xxl {
                padding-left: 1rem !important;
                padding-right: 1rem !important;
                max-width: 100%;
            }
            
            main.container-xxl {
                padding-left: 0.75rem !important;
                padding-right: 0.75rem !important;
            }
            
            .unified-form-section {
                margin-left: 0;
                margin-right: 0;
                border-radius: 8px;
            }
            
            .section-header {
                padding: 1rem;
            }
            
            .section-header h3 {
                font-size: 1.1rem;
            }
            
            .form-column {
                gap: 1rem;
            }
            
            .logo-upload-container {
                padding: 1rem;
            }
            
            .logo-preview {
                max-width: 200px;
                margin: 0 auto;
            }
        }
        
        @media (max-width: 576px) {
            .container-xxl {
                padding-left: 0.5rem !important;
                padding-right: 0.5rem !important;
            }
            
            main.container-xxl {
                padding-left: 0.5rem !important;
                padding-right: 0.5rem !important;
            }
            
            .section-content {
                padding: 0.75rem;
            }
            
            .settings-group {
                padding: 0.75rem;
            }
            
            .section-header h3 {
                font-size: 1rem;
            }
            
            .form-label {
                font-size: 0.85rem;
            }
            
            .btn {
                font-size: 0.9rem;
                padding: 0.5rem 1rem;
            }
        }
        
        /* تصميم الأزرار الجديدة */
        .nav-buttons {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 25px 0;
            margin-bottom: 20px;
            width: 100%;
            overflow-x: hidden;
        }
        
        .nav-buttons .container-xxl {
            max-width: 100%;
        }
        
        .nav-buttons .row {
            margin-left: 0;
            margin-right: 0;
        }
        
        .nav-button {
            background: white;
            border: none;
            border-radius: 20px;
            padding: 25px 20px;
            text-align: center;
            color: #333;
            text-decoration: none;
            transition: all 0.4s ease;
            box-shadow: 0 6px 20px rgba(0,0,0,0.1);
            min-height: 140px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
        }
        
        .nav-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }
        
        .nav-button:hover::before {
            left: 100%;
        }
        
        .nav-button:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: 0 12px 30px rgba(0,0,0,0.15);
            color: #333;
            text-decoration: none;
        }
        
        .nav-button i {
            font-size: 3rem;
            margin-bottom: 15px;
            transition: all 0.3s ease;
        }
        
        .nav-button:hover i {
            transform: scale(1.1) rotate(5deg);
        }
        
        .nav-button h6 {
            margin: 0;
            font-weight: 700;
            font-size: 16px;
            margin-bottom: 5px;
        }
        
        .nav-button p {
            margin: 0;
            font-size: 13px;
            opacity: 0.8;
            line-height: 1.4;
        }
        
        /* الألوان المختلفة للأزرار */
        .btn-accounts i { 
            color: #17a2b8;
            background: linear-gradient(135deg, #17a2b8, #20c997);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .btn-offers i { 
            color: #28a745;
            background: linear-gradient(135deg, #28a745, #20c997);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .btn-products i { 
            color: white !important;
        }
        
        /* الزر النشط */
        .nav-button.active {
            background: #1a3051;
            color: white;
            transform: scale(1.05);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
        }
        
        .nav-button.active h6,
        .nav-button.active p {
            color: white;
        }
        
        @media (max-width: 768px) {
            .nav-button {
                min-height: 120px;
                padding: 18px 15px;
            }
            
            .nav-button i {
                font-size: 2.5rem;
                margin-bottom: 10px;
            }
            
            .nav-button h6 {
                font-size: 14px;
            }
            
            .nav-button p {
                font-size: 11px;
            }
        }
        
        @media (max-width: 576px) {
            .nav-button {
                min-height: 110px;
                padding: 15px 10px;
            }
            
            .nav-button i {
                font-size: 2rem;
            }
            
            .nav-button h6 {
                font-size: 13px;
            }
            
            .nav-button p {
                font-size: 10px;
                line-height: 1.3;
            }
        }
        
    </style>
</head>
<body>
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-spinner"></div>
    </div>

    <!-- أزرار التنقل الجديدة -->
    <div class="nav-buttons">
        <div class="container-xxl px-3">
            <div class="row g-4 justify-content-center">
                <div class="col-12 col-md-4">
                    <a href="products.html" class="nav-button btn-products">
                        <i class="fas fa-box" style="color: #007bff !important"></i>
                        <h6>إدارة المنتجات</h6>
                        <p>إضافة وتعديل وحذف المنتجات</p>
                    </a>
                </div>
                <div class="col-12 col-md-4">
                    <a href="store-details.html" class="nav-button btn-offers">
                        <i class="fas fa-tags"></i>
                        <h6>إدارة العروض</h6>
                        <p>إنشاء وإدارة عروض المتجر</p>
                    </a>
                </div>
                <div class="col-12 col-md-4">
                    <a href="account.html" class="nav-button btn-accounts active">
                        <i class="fas fa-user-cog"></i>
                        <h6>إدارة الحساب</h6>
                        <p>إعدادات وبيانات الحساب</p>
                    </a>
                </div>
            </div>
        </div>
    </div>
    
 

    <main class="container-xxl px-3 my-4">
        <form id="unifiedProfileForm" class="unified-form-section">
            <div class="section-header">
                <h3><i class="fas fa-user-cog"></i>معلومات الحساب الشخصي</h3>
            </div>
            
            <div class="section-content">
                <div class="form-grid">
                    <div class="form-column">
                        <div class="settings-group">
                            <h5><i class="fas fa-id-card"></i>المعلومات الشخصية</h5>
                            
                            <div class="account-info">
                                <div class="account-icon">
                                    <i class="fas fa-user"></i>
                                </div>
                                <div class="account-details">
                                    <div class="account-name">أحمد محمد</div>
                                    <div class="account-role">صاحب المتجر</div>
                                </div>
                            </div>
                            
                            <div class="mb-3">
                                <label class="form-label">الاسم الكامل</label>
                                <input type="text" class="form-control" value="أحمد محمد" name="fullName" id="fullName" required pattern="[A-Za-z\u0600-\u06FF\s]+" title="يجب أن يحتوي الاسم على أحرف فقط">
                                <div class="validation-error" id="fullNameError">الاسم الكامل مطلوب ويجب أن يحتوي على أحرف فقط</div>
                            </div>
                            
                            <div class="mb-3">
                                <label class="form-label">رقم الهاتف</label>
                                <input type="tel" class="form-control" value="0791234567" name="phoneNumber" id="phoneNumber" required pattern="07\d{8}" title="يجب أن يبدأ رقم الهاتف بـ 07 ويتكون من 10 أرقام">
                                <div class="validation-error" id="phoneNumberError">رقم الهاتف غير صحيح. يجب أن يبدأ بـ 07 ويتكون من 10 أرقام</div>
                            </div>
                            
                            <!-- زر الحفظ تحت الحقول -->
                            <div class="text-center mt-4">
                                <button type="submit" class="btn btn-primary px-4">
                                    <i class="fas fa-save me-2"></i>حفظ التعديلات
                                </button>
                            </div>
                        </div>

                        <div class="settings-group">
                            <h5><i class="fas fa-lock"></i>الأمان</h5>
                            <div class="mb-3">
                                <label class="form-label">كلمة المرور الحالية</label>
                                <div class="password-input-group">
                                    <input type="password" class="form-control password-field" value="1234" name="passwordField" id="passwordField" readonly>
                                    <button type="button" class="password-toggle" id="togglePassword">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="text-center">
                                <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#changePasswordModal">
                                    <i class="fas fa-key me-2"></i>تغيير كلمة المرور
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="form-column">
                       <div class="settings-group">
                   
                            <div class="mb-3">
                                <label class="form-label fw-bold">شعار المتجر</label>
                                <div class="logo-upload-container">
                                    <div class="logo-preview" id="logoPreview">
                                        <img src="https://marketplace.canva.com/EAFYzECeGEk/1/0/1600w/canva-%D8%B4%D8%B9%D8%A7%D8%B1-logo-%D9%85%D8%AA%D8%AC%D8%B1-%D9%84%D9%84%D9%85%D8%A8%D9%84%D8%A7%D8%A8%D8%B3-%D8%A7%D9%88-%D8%A7%D9%84%D8%A7%D8%B2%D9%8A%D8%A7%D8%A1-%D8%A7%D9%88-%D8%A7%D9%84%D9%85%D9%81%D8%B1%D9%88%D8%B4%D8%A7%D8%AA-vPrqHjFSvAE.jpg" 
                                             alt="شعار المتجر" 
                                             class="logo-img">
                                        <button type="button" class="logo-remove-btn" id="removeLogoBtn">
                                            <i class="fas fa-times"></i>
                                        </button>
                                    </div>
                                    
                                    <div class="logo-actions mt-3">
                                        <button type="button" class="btn btn-outline-primary btn-sm" onclick="document.getElementById('logoInput').click()">
                                            <i class="fas fa-upload me-1"></i> رفع شعار جديد
                                        </button>
                                        <input type="file" id="logoInput" name="logoInput" accept="image/*" style="display: none;" onchange="showAppearanceSaveBtn()">
                                    </div>
                                </div>
                            </div>
                           <h5><i class="fas fa-palette"></i> إعدادات المظهر</h5>

                            <div class="mb-4">
                                <label class="form-label fw-bold">لون خلفية الموقع</label>
                                <p class="text-muted small mb-2">اختر اللون الذي تظهر به خلفية الصفحة الرئيسية</p>
                                <div class="color-settings d-flex align-items-center gap-3">
                                    <input type="color" 
                                           class="form-control form-control-color border" 
                                           name="backgroundColor" 
                                           id="backgroundColor" 
                                           value="#f5f7fb" 
                                           title="اختر لون الخلفية"
                                           onchange="showAppearanceSaveBtn()">
                                    <div class="color-preview-box" id="bgPreview"></div>
                                </div>
                            </div>

                            <!-- زر حفظ التعديلات - يظهر عند التغيير -->
                            <div class="text-center mt-4" id="appearanceSaveBtn" style="display: none;">
                                <button type="button" class="btn btn-primary px-4" onclick="saveAppearanceSettings()">
                                    <i class="fas fa-save me-2"></i>حفظ التعديلات
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

               
            </div>
        </form>
    </main>

    <div class="modal fade" id="changePasswordModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header text-white text-center" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                    <h5 class="modal-title w-100">تغيير كلمة المرور</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="changePasswordForm">
                        <div class="mb-3">
                            <label class="form-label">كلمة المرور الحالية</label>
                            <div class="password-input-group">
                                <input type="password" class="form-control password-field" id="currentPassword" placeholder="ادخل كلمة المرور الحالية" required>
                                <button type="button" class="password-toggle toggle-current-password">
                                    <i class="fas fa-eye"></i>
                                </button>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label">كلمة المرور الجديدة</label>
                            <div class="password-input-group">
                                <input type="password" class="form-control password-field" id="newPassword" placeholder="ادخل كلمة المرور الجديدة" required>
                                <button type="button" class="password-toggle toggle-new-password">
                                    <i class="fas fa-eye"></i>
                                </button>
                            </div>
                            <div class="text-muted small mt-1">يجب أن تحتوي كلمة المرور على 8 أحرف على الأقل</div>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label">تأكيد كلمة المرور الجديدة</label>
                            <div class="password-input-group">
                                <input type="password" class="form-control password-field" id="confirmPassword" placeholder="اعد إدخال كلمة المرور الجديدة" required>
                                <button type="button" class="password-toggle toggle-confirm-password">
                                    <i class="fas fa-eye"></i>
                                </button>
                            </div>
                            <div class="invalid-feedback text-center" id="passwordMatchError" style="display: none;">
                                كلمات المرور غير متطابقة
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer justify-content-center">
                    <div class="d-flex gap-3">
                        <button type="button" class="btn btn-primary px-4 py-2 fw-semibold" id="savePasswordBtn">
                            حفظ
                        </button>
                        <button type="button" class="btn btn-outline-secondary px-4 py-2 fw-semibold" data-bs-dismiss="modal">
                            إلغاء
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <footer class="bg-light text-center py-3 mt-auto shadow-sm">
        <div class="container">
            <p class="mb-0">
                © 2025 <a href="https://codnaitsolutions.com/" target="_blank" class="text-decoration-none text-dark">By Codna IT Solution</a>
            </p>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // دالة مساعدة لإخفاء طبقة التحميل بأمان
        function hideLoadingOverlay() {
            const loadingOverlay = document.getElementById('loadingOverlay');
            if (loadingOverlay) {
                loadingOverlay.style.display = 'none';
            }
        }

        // دالة لإظهار طبقة التحميل
        function showLoadingOverlay() {
            const loadingOverlay = document.getElementById('loadingOverlay');
            if (loadingOverlay) {
                loadingOverlay.style.display = 'flex';
            }
        }

        document.addEventListener('DOMContentLoaded', function() {
            // إخفاء طبقة التحميل عند تحميل الصفحة للتأكد
            hideLoadingOverlay();
            
            // إعداد إظهار/إخفاء كلمة المرور
            const setupPasswordToggle = (toggleBtn, passwordField) => {
                toggleBtn.addEventListener('click', function() {
                    const type = passwordField.getAttribute('type') === 'password' ? 'text' : 'password';
                    passwordField.setAttribute('type', type);
                    this.innerHTML = type === 'password' ? '<i class="fas fa-eye"></i>' : '<i class="fas fa-eye-slash"></i>';
                });
            };

            // إعداد جميع حقول كلمة المرور
            setupPasswordToggle(document.getElementById('togglePassword'), document.getElementById('passwordField'));
            setupPasswordToggle(document.querySelector('.toggle-current-password'), document.getElementById('currentPassword'));
            setupPasswordToggle(document.querySelector('.toggle-new-password'), document.getElementById('newPassword'));
            setupPasswordToggle(document.querySelector('.toggle-confirm-password'), document.getElementById('confirmPassword'));

            // تحديث الألوان في الوقت الحقيقي
            function updateColors() {
                const backgroundColor = document.getElementById('backgroundColor').value;
                document.getElementById('bgPreview').style.backgroundColor = backgroundColor;
                document.body.style.backgroundColor = backgroundColor;
                document.documentElement.style.setProperty('--light-bg', backgroundColor);
            }

            document.getElementById('backgroundColor').addEventListener('input', updateColors);
            updateColors();

            // إعداد رفع الشعار
            const logoInput = document.getElementById('logoInput');
            const logoPreview = document.getElementById('logoPreview');
            
            logoInput.addEventListener('change', function(e) {
                if (e.target.files.length > 0) {
                    const file = e.target.files[0];
                    const reader = new FileReader();
                    
                    reader.onload = function(e) {
                        logoPreview.innerHTML = `
                            <img src="${e.target.result}" alt="شعار المتجر" class="logo-img">
                            <button type="button" class="logo-remove-btn" id="removeLogoBtn">
                                <i class="fas fa-times"></i>
                            </button>
                        `;
                        
                        document.getElementById('removeLogoBtn').addEventListener('click', removeLogo);
                    };
                    
                    reader.readAsDataURL(file);
                }
            });

            function removeLogo() {
                Swal.fire({
                    title: 'هل أنت متأكد؟',
                    text: "سيتم إزالة الشعار الحالي",
                    icon: 'warning',
                    showCancelButton: true,
                    confirmButtonColor: '#d33',
                    cancelButtonColor: '#3085d6',
                    confirmButtonText: 'نعم، إزالة',
                    cancelButtonText: 'إلغاء'
                }).then((result) => {
                    if (result.isConfirmed) {
                        logoPreview.innerHTML = `
                            <div class="placeholder">
                                <i class="fas fa-image fa-3x text-muted"></i>
                                <p class="mt-2 text-muted">لا يوجد شعار</p>
                            </div>
                            <button type="button" class="logo-remove-btn" id="removeLogoBtn" style="display: none;">
                                <i class="fas fa-times"></i>
                            </button>
                        `;
                        
                        Swal.fire('تم الحذف!', 'تم إزالة الشعار بنجاح.', 'success');
                    }
                });
            }

            document.getElementById('removeLogoBtn').addEventListener('click', removeLogo);

            // التحقق من صحة المدخلات
            const fullNameInput = document.getElementById('fullName');
            const phoneNumberInput = document.getElementById('phoneNumber');
            
            // التحقق من الاسم الكامل أثناء الكتابة
            fullNameInput.addEventListener('input', function() {
                // إزالة أي أرقام مباشرة أثناء الكتابة
                this.value = this.value.replace(/[0-9]/g, '');

                // تحقق من صحة الاسم
                const nameRegex = /^[A-Za-z\u0600-\u06FF\s]+$/;
                if (this.value.trim() === '' || !nameRegex.test(this.value)) {
                    document.getElementById('fullNameError').style.display = 'block';
                    this.classList.add('is-invalid');
                } else {
                    document.getElementById('fullNameError').style.display = 'none';
                    this.classList.remove('is-invalid');
                }
            });

            // التحقق من رقم الهاتف أثناء الكتابة
            phoneNumberInput.addEventListener('input', function() {
                const phoneRegex = /^07\d{0,8}$/; // السماح بالكتابة خطوة خطوة حتى تصل لـ10 أرقام
                if (!phoneRegex.test(this.value)) {
                    document.getElementById('phoneNumberError').style.display = 'block';
                    this.classList.add('is-invalid');
                } else if (this.value.length === 10) { // إذا وصل للطول الصحيح
                    document.getElementById('phoneNumberError').style.display = 'none';
                    this.classList.remove('is-invalid');
                } else {
                    document.getElementById('phoneNumberError').style.display = 'block';
                    this.classList.add('is-invalid');
                }
            });

            // إرسال النموذج الموحد
            const unifiedForm = document.getElementById('unifiedProfileForm');
            unifiedForm.addEventListener('submit', function(e) {
                e.preventDefault();
                saveChanges();
            });

            // تغيير كلمة المرور - الإصدار المعدل
            document.getElementById('savePasswordBtn').addEventListener('click', function() {
                const currentPass = document.getElementById('currentPassword').value;
                const newPass = document.getElementById('newPassword').value;
                const confirmPass = document.getElementById('confirmPassword').value;
                const passwordMatchError = document.getElementById('passwordMatchError');
                
                // التحقق من أن جميع الحقول مملوءة
                if (!currentPass || !newPass || !confirmPass) {
                    Swal.fire({
                        icon: 'error',
                        title: 'خطأ',
                        text: 'يرجى ملء جميع الحقول',
                        confirmButtonText: 'حسنًا'
                    });
                    return;
                }
                
                // التحقق من طول كلمة المرور الجديدة
                if (newPass.length < 8) {
                    Swal.fire({
                        icon: 'error',
                        title: 'خطأ',
                        text: 'يجب أن تحتوي كلمة المرور على 8 أحرف على الأقل',
                        confirmButtonText: 'حسنًا'
                    });
                    return;
                }
                
                // التحقق من تطابق كلمتي المرور
                if (newPass !== confirmPass) {
                    passwordMatchError.style.display = 'block';
                    document.getElementById('confirmPassword').classList.add('is-invalid');
                    return;
                } else {
                    passwordMatchError.style.display = 'none';
                    document.getElementById('confirmPassword').classList.remove('is-invalid');
                    
                    // إظهار طبقة التحميل
                    showLoadingOverlay();
                    
                    // محاكاة عملية تغيير كلمة المرور
                    setTimeout(() => {
                        // إخفاء طبقة التحميل بغض النظر عن نتيجة العملية
                        hideLoadingOverlay();
                        
                        // عرض رسالة النجاح
                        Swal.fire({
                            icon: 'success',
                            title: 'تم تغيير كلمة المرور!',
                            text: 'تم تحديث كلمة المرور بنجاح.',
                            confirmButtonText: 'حسنًا'
                        }).then(() => {
                            const modal = bootstrap.Modal.getInstance(document.getElementById('changePasswordModal'));
                            if (modal) {
                                modal.hide();
                            }
                            document.getElementById('changePasswordForm').reset();
                        });
                    }, 1500);
                }
            });
        });

        function saveChanges() {
            const fullName = document.getElementById('fullName').value;
            const phoneNumber = document.getElementById('phoneNumber').value;
            
            const nameRegex = /^[A-Za-z\u0600-\u06FF\s]+$/;
            if (fullName.trim() === '' || !nameRegex.test(fullName)) {
                document.getElementById('fullNameError').style.display = 'block';
                document.getElementById('fullName').classList.add('is-invalid');
                return;
            }
            
            const phoneRegex = /^07\d{8}$/;
            if (!phoneRegex.test(phoneNumber)) {
                document.getElementById('phoneNumberError').style.display = 'block';
                document.getElementById('phoneNumber').classList.add('is-invalid');
                return;
            }
            
            showLoadingOverlay();
            
            setTimeout(() => {
                hideLoadingOverlay();
                
                Swal.fire({
                    icon: 'success',
                    title: 'تم الحفظ!',
                    text: 'تم حفظ جميع التعديلات بنجاح.',
                    confirmButtonText: 'حسناً',
                    timer: 2000,
                    timerProgressBar: true
                });
            }, 1500);
        }

        // إظهار زر الحفظ عند تغيير إعدادات المظهر
        function showAppearanceSaveBtn() {
            document.getElementById('appearanceSaveBtn').style.display = 'block';
        }

        // حفظ إعدادات المظهر
        function saveAppearanceSettings() {
            const backgroundColor = document.getElementById('backgroundColor').value;
            const logoInput = document.getElementById('logoInput').files[0];
            
            showLoadingOverlay();
            
            setTimeout(() => {
                hideLoadingOverlay();
                
                Swal.fire({
                    icon: 'success',
                    title: 'تم الحفظ!',
                    text: 'تم حفظ إعدادات المظهر بنجاح.',
                    confirmButtonText: 'حسناً',
                    timer: 2000,
                    timerProgressBar: true
                });
                
                // إخفاء زر الحفظ بعد النجاح
                document.getElementById('appearanceSaveBtn').style.display = 'none';
            }, 1500);
        }
    </script>
</body>
</html>